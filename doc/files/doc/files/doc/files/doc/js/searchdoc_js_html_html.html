<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>searchdoc_js_html.html</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../../../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../../../../css/github.css" type="text/css" media="screen" />
<script src="../../../../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            searchdoc_js_html.html
        </h1>
        <ul class="files">
            <li>doc/files/doc/files/doc/js/searchdoc_js_html.html</li>
            <li>Last modified: 2014-05-16 16:46:03 +0200</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>&lt;!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0 Transitional//EN”</p>

<pre><code>&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</code></pre>

<p>&lt;html xmlns=“<a
href="http://www.w3.org/1999/xhtml">www.w3.org/1999/xhtml</a>”
xml:lang=“en” lang=“en”&gt; &lt;head&gt;</p>

<pre><code>&lt;title&gt;searchdoc_js.html&lt;/title&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;../../../../../css/reset.css&quot; type=&quot;text/css&quot; media=&quot;screen&quot; /&gt;</code></pre>

<p>&lt;link rel=“stylesheet” href=“../../../../../css/main.css”
type=“text/css” media=“screen” /&gt; &lt;link rel=“stylesheet”
href=“../../../../../css/github.css” type=“text/css” media=“screen” /&gt;
&lt;script src=“../../../../../js/jquery-1.3.2.min.js”
type=“text/javascript” charset=“utf-8”&gt;&lt;/script&gt; &lt;script
src=“../../../../../js/jquery-effect.js” type=“text/javascript”
charset=“utf-8”&gt;&lt;/script&gt; &lt;script
src=“../../../../../js/main.js” type=“text/javascript”
charset=“utf-8”&gt;&lt;/script&gt; &lt;script
src=“../../../../../js/highlight.pack.js” type=“text/javascript”
charset=“utf-8”&gt;&lt;/script&gt;</p>

<p>&lt;/head&gt;</p>

<p>&lt;body&gt;</p>

<pre><code>&lt;div class=&quot;banner&quot;&gt;

    &lt;h1&gt;
        searchdoc_js.html
    &lt;/h1&gt;
    &lt;ul class=&quot;files&quot;&gt;
        &lt;li&gt;doc/files/doc/js/searchdoc_js.html&lt;/li&gt;
        &lt;li&gt;Last modified: 2014-05-16 15:30:30 +0200&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;

&lt;div id=&quot;bodyContent&quot;&gt;
    &lt;div id=&quot;content&quot;&gt;

&lt;div class=&quot;description&quot;&gt;</code></pre>

<p>&lt;p&gt;&amp;lt;!DOCTYPE html PUBLIC “-//W3C//DTD XHTML 1.0
Transitional//EN”&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>&amp;quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</pre</code>&gt;</p>

<p>&lt;p&gt;&amp;lt;html xmlns=“&lt;a href=“<a
href="http://www.w3.org/1999/xhtml">www.w3.org/1999/xhtml</a">www.w3.org/1999/xhtml”>www.w3.org/1999/xhtml</a</a>&gt;”
xml:lang=“en” lang=“en”&amp;gt; &amp;lt;head&amp;gt;&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>&amp;lt;title&amp;gt;searchdoc.js&amp;lt;/title&amp;gt;
&amp;lt;meta http-equiv=&amp;quot;Content-Type&amp;quot;
content=&amp;quot;text/html; charset=UTF-8&amp;quot; /&amp;gt; &amp;lt;link
rel=&amp;quot;stylesheet&amp;quot;
href=&amp;quot;../../../css/reset.css&amp;quot;
type=&amp;quot;text/css&amp;quot; media=&amp;quot;screen&amp;quot;
/&amp;gt;</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;&amp;lt;link rel=“stylesheet” href=“../../../css/main.css”
type=“text/css” media=“screen” /&amp;gt; &amp;lt;link rel=“stylesheet”
href=“../../../css/github.css” type=“text/css” media=“screen” /&amp;gt;
&amp;lt;script src=“../../../js/jquery-1.3.2.min.js” type=“text/javascript”
charset=“utf-8”&amp;gt;&amp;lt;/script&amp;gt; &amp;lt;script
src=“../../../js/jquery-effect.js” type=“text/javascript”
charset=“utf-8”&amp;gt;&amp;lt;/script&amp;gt; &amp;lt;script
src=“../../../js/main.js” type=“text/javascript”
charset=“utf-8”&amp;gt;&amp;lt;/script&amp;gt; &amp;lt;script
src=“../../../js/highlight.pack.js” type=“text/javascript”
charset=“utf-8”&amp;gt;&amp;lt;/script&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;/head&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;body&amp;gt;&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;quot;banner&amp;quot;&amp;gt;</p>

<pre><code>&amp;lt;h1&amp;gt;
    searchdoc.js
&amp;lt;/h1&amp;gt;
&amp;lt;ul class=&amp;quot;files&amp;quot;&amp;gt;
    &amp;lt;li&amp;gt;doc/js/searchdoc.js&amp;lt;/li&amp;gt;
    &amp;lt;li&amp;gt;Last modified: 2014-05-16 15:28:00 +0200&amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;</code></pre>

<p>&amp;lt;/div&amp;gt;</p>

<p>&amp;lt;div id=&amp;quot;bodyContent&amp;quot;&amp;gt;</p>

<pre><code>&amp;lt;div id=&amp;quot;content&amp;quot;&amp;gt;</code></pre>

<p>&amp;lt;div
class=&amp;quot;description&amp;quot;&amp;gt;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;Searchdoc = {};&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;// navigation.js
——————————————&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;Searchdoc.Navigation = new function()
{&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;this.initNavigation =
function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var _this = this;</p>

<p>$(document).keydown(function(e) {</p>

<pre><code>_this.onkeydown(e);</code></pre>

<p>}).keyup(function(e) {</p>

<pre><code>_this.onkeyup(e);</code></pre>

<p>});</p>

<p>this.navigationActive = true;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.setNavigationActive = function(state) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>this.navigationActive = state;
this.clearMoveTimeout();</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.onkeyup = function(e) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!this.navigationActive) return;
switch(e.keyCode) {</p>

<pre><code>case 37: //Event.KEY_LEFT:
case 38: //Event.KEY_UP:
case 39: //Event.KEY_RIGHT:
case 40: //Event.KEY_DOWN:
case 73: // i - qwerty
case 74: // j
case 75: // k
case 76: // l
case 67: // c - dvorak
case 72: // h 
case 84: // t
case 78: // n
    this.clearMoveTimeout();
    break;
}&lt;/code&gt;&lt;/pre&gt;</code></pre>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.onkeydown = function(e) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!this.navigationActive) return;
switch(e.keyCode) {</p>

<pre><code>case 37: //Event.KEY_LEFT:
case 74: // j (qwerty)
case 72: // h (dvorak)
    if (this.moveLeft()) e.preventDefault();
    break;
case 38: //Event.KEY_UP:
case 73: // i (qwerty)
case 67: // c (dvorak)
    if (e.keyCode == 38 || e.ctrlKey) {
        if (this.moveUp()) e.preventDefault();
        this.startMoveTimeout(false);
    }
    break;
case 39: //Event.KEY_RIGHT:
case 76: // l (qwerty)
case 78: // n (dvorak)
    if (this.moveRight()) e.preventDefault();
    break;
case 40: //Event.KEY_DOWN:
case 75: // k (qwerty)
case 84: // t (dvorak)
    if (e.keyCode == 40 || e.ctrlKey) {
        if (this.moveDown()) e.preventDefault();
        this.startMoveTimeout(true);
    }
    break;
case 9: //Event.KEY_TAB:
case 13: //Event.KEY_RETURN:
    if (this.$current) this.select(this.$current);
    break;
case 83: // s (qwerty)
case 79: // o (dvorak)
    if (e.ctrlKey) {
        $(&amp;amp;#39;#search&amp;amp;#39;).focus();
        e.preventDefault();
    }
    break;</code></pre>

<p>} if (e.ctrlKey &amp;amp;amp;&amp;amp;amp; e.shiftKey)
this.select(this.$current);&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.clearMoveTimeout = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>clearTimeout(this.moveTimeout);  this.moveTimeout =
null;</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.startMoveTimeout = function(isDown) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!$.browser.mozilla &amp;amp;amp;&amp;amp;amp;
!$.browser.opera) return; if (this.moveTimeout) this.clearMoveTimeout();
var _this = this;</p>

<p>var go = function() {</p>

<pre><code>if (!_this.moveTimeout) return;
_this[isDown ? &amp;amp;#39;moveDown&amp;amp;#39; : &amp;amp;#39;moveUp&amp;amp;#39;]();
_this.moveTimout = setTimeout(go, 100);</code></pre>

<p>} this.moveTimeout = setTimeout(go, 200);&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.moveRight = function() { }&lt;/p&gt;</p>

<p>&lt;p&gt;this.moveLeft = function() { }&lt;/p&gt;</p>

<p>&lt;p&gt;this.move = function(isDown) { }&lt;/p&gt;</p>

<p>&lt;p&gt;this.moveUp = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>return this.move(false);</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.moveDown = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>return this.move(true);</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;}&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;// scrollIntoView.js
————————————–&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;function scrollIntoView(element, view)
{&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;var offset, viewHeight,
viewScroll, height; offset = element.offsetTop; height =
element.offsetHeight; viewHeight = view.offsetHeight; viewScroll =
view.scrollTop; if (offset - viewScroll + height &amp;amp;gt; viewHeight)
{&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>view.scrollTop = offset - viewHeight +
height;</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;} if (offset &amp;amp;lt; viewScroll) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>view.scrollTop = offset;</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;}&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;// panel.js
———————————————–&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;Searchdoc.Panel = function(element, data, tree,
frame) {&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;this.$element = $(element);
this.$input = $(&amp;amp;#39;input&amp;amp;#39;, element).eq(0);
this.$result = $(&amp;amp;#39;.result ul&amp;amp;#39;, element).eq(0);
this.frame = frame; this.$current = null; this.$view =
this.$result.parent(); this.data = data; this.searcher = new
Searcher(data.index);&lt;/p&gt;</p>

<p>&lt;p&gt;this.tree = new Searchdoc.Tree($(&amp;amp;#39;.tree&amp;amp;#39;,
element), tree, this);
this.init();&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;}&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;Searchdoc.Panel.prototype = $.extend({},
Searchdoc.Navigation, new function() {&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;var suid = 1;&lt;/p&gt;</p>

<p>&lt;p&gt;this.init = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var _this = this; var observer = function() {</p>

<pre><code>_this.search(_this.$input[0].value);</code></pre>

<p>}; this.$input.keyup(observer); this.$input.click(observer); //
mac&amp;amp;#39;s clear field</p>

<p>this.searcher.ready(function(results, isLast) {</p>

<pre><code>_this.addResults(results, isLast);</code></pre>

<p>})</p>

<p>this.$result.click(function(e) {</p>

<pre><code>_this.$current.removeClass(&amp;amp;#39;current&amp;amp;#39;);
_this.$current = $(e.target).closest(&amp;amp;#39;li&amp;amp;#39;).addClass(&amp;amp;#39;current&amp;amp;#39;);
_this.select();
_this.$input.focus();</code></pre>

<p>});</p>

<p>this.initNavigation();
this.setNavigationActive(false);&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.search = function(value, selectFirstMatch) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;value = jQuery.trim(value).toLowerCase();
this.selectFirstMatch = selectFirstMatch; if (value) {</p>

<pre><code>this.$element.removeClass(&amp;amp;#39;panel_tree&amp;amp;#39;).addClass(&amp;amp;#39;panel_results&amp;amp;#39;);
this.tree.setNavigationActive(false);
this.setNavigationActive(true);</code></pre>

<p>} else {</p>

<pre><code>this.$element.addClass(&amp;amp;#39;panel_tree&amp;amp;#39;).removeClass(&amp;amp;#39;panel_results&amp;amp;#39;);
this.tree.setNavigationActive(true);
this.setNavigationActive(false);</code></pre>

<p>} if (value != this.lastQuery) {</p>

<pre><code>this.lastQuery = value;
this.firstRun = true;
this.searcher.find(value);</code></pre>

<p>}&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.addResults = function(results, isLast) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var target = this.$result.get(0); if (this.firstRun
&amp;amp;amp;&amp;amp;amp; (results.length &amp;amp;gt; 0 || isLast)) {</p>

<pre><code>this.$current = null;
this.$result.empty();</code></pre>

<p>} for (var i=0, l = results.length; i &amp;amp;lt; l; i++) {</p>

<pre><code>target.appendChild(renderItem.call(this, results[i]));</code></pre>

<p>}; if (this.firstRun &amp;amp;amp;&amp;amp;amp; results.length &amp;amp;gt;
0) {</p>

<pre><code>this.firstRun = false;
this.$current = $(target.firstChild);
this.$current.addClass(&amp;amp;#39;current&amp;amp;#39;);
if (this.selectFirstMatch) this.select();
scrollIntoView(this.$current[0], this.$view[0])</code></pre>

<p>} if (jQuery.browser.msie) <a href="0">this.$element</a>.className +=
&amp;amp;#39;&amp;amp;#39;;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.open = function(src) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>this.frame.location.href = &amp;amp;#39;../&amp;amp;#39; +
src; if (this.frame.highlight)
this.frame.highlight(src);</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.select = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>this.open(this.$current.data(&amp;amp;#39;path&amp;amp;#39;));</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.move = function(isDown) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!this.$current) return; var $next =
this.$current[isDown ? &amp;amp;#39;next&amp;amp;#39; :
&amp;amp;#39;prev&amp;amp;#39;](); if ($next.length) {</p>

<pre><code>this.$current.removeClass(&amp;amp;#39;current&amp;amp;#39;);
$next.addClass(&amp;amp;#39;current&amp;amp;#39;);
scrollIntoView($next[0], this.$view[0]);
this.$current = $next;</code></pre>

<p>} return true;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function renderItem(result) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var li =
document.createElement(&amp;amp;#39;li&amp;amp;#39;),</p>

<pre><code>html = &amp;amp;#39;&amp;amp;#39;, badge = result.badge;</code></pre>

<p>html += &amp;amp;#39;&amp;amp;lt;h1&amp;amp;gt;&amp;amp;#39; +
hlt(result.title); if (result.params) html +=
&amp;amp;#39;&amp;amp;lt;i&amp;amp;gt;&amp;amp;#39; + result.params +
&amp;amp;#39;&amp;amp;lt;/i&amp;amp;gt;&amp;amp;#39;; html +=
&amp;amp;#39;&amp;amp;lt;/h1&amp;amp;gt;&amp;amp;#39;; html +=
&amp;amp;#39;&amp;amp;lt;p&amp;amp;gt;&amp;amp;#39;; if (typeof badge !=
&amp;amp;#39;undefined&amp;amp;#39;) {</p>

<pre><code>html += &amp;amp;#39;&amp;amp;lt;span class=&amp;amp;quot;badge badge_&amp;amp;#39; + (badge % 6 + 1) + &amp;amp;#39;&amp;amp;quot;&amp;amp;gt;&amp;amp;#39; + escapeHTML(this.data.badges[badge] || &amp;amp;#39;unknown&amp;amp;#39;) + &amp;amp;#39;&amp;amp;lt;/span&amp;amp;gt;&amp;amp;#39;;</code></pre>

<p>} html += hlt(result.namespace) +
&amp;amp;#39;&amp;amp;lt;/p&amp;amp;gt;&amp;amp;#39;; if (result.snippet)
html += &amp;amp;#39;&amp;amp;lt;p
class=&amp;amp;quot;snippet&amp;amp;quot;&amp;amp;gt;&amp;amp;#39; +
escapeHTML(result.snippet) +
&amp;amp;#39;&amp;amp;lt;/p&amp;amp;gt;&amp;amp;#39;; li.innerHTML = html;
jQuery.data(li, &amp;amp;#39;path&amp;amp;#39;, result.path); return
li;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function hlt(html) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>return escapeHTML(html).replace(/\u0001/g,
&amp;amp;#39;&amp;amp;lt;b&amp;amp;gt;&amp;amp;#39;).replace(/\u0002/g,
&amp;amp;#39;&amp;amp;lt;/b&amp;amp;gt;&amp;amp;#39;)</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function escapeHTML(html) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;return <a
href="&amp;amp;&amp;lt;&amp;gt;">html.replace(/</a>/g, function© {</p>

<pre><code>return &amp;amp;#39;&amp;amp;amp;#&amp;amp;#39; + c.charCodeAt(0) + &amp;amp;#39;;&amp;amp;#39;;</code></pre>

<p>});&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;});&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;// tree.js
————————————————&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;Searchdoc.Tree = function(element, tree, panel)
{&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;pre&amp;gt;<code>this.$element = $(element); this.$list =
$(&amp;amp;#39;ul&amp;amp;#39;, element); this.tree = tree; this.panel =
panel; this.init();</code>&amp;lt;/pre&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;}&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;Searchdoc.Tree.prototype = $.extend({},
Searchdoc.Navigation, new function() {&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;this.init = function()
{&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var stopper =
document.createElement(&amp;amp;#39;li&amp;amp;#39;); stopper.className =
&amp;amp;#39;stopper&amp;amp;#39;; <a
href="0">this.$list</a>.appendChild(stopper); for (var i=0, l =
this.tree.length; i &amp;amp;lt; l; i++) {</p>

<pre><code>buildAndAppendItem.call(this, this.tree[i], 0, stopper);</code></pre>

<p>}; var _this = this; this.$list.click(function(e) {</p>

<pre><code>var $target = $(e.target),
    $li = $target.closest(&amp;amp;#39;li&amp;amp;#39;);
if ($target.hasClass(&amp;amp;#39;icon&amp;amp;#39;)) {
    _this.toggle($li);
} else {
    _this.select($li);
}</code></pre>

<p>})</p>

<p>this.initNavigation(); if (jQuery.browser.msie) document.body.className +=
&amp;amp;#39;&amp;amp;#39;;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.select = function($li) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>this.highlight($li); var path =
$li[0].searchdoc_tree_data.path; if (path)
this.panel.open(path);</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.highlight = function($li) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>if (this.$current)
this.$current.removeClass(&amp;amp;#39;current&amp;amp;#39;); this.$current
= $li.addClass(&amp;amp;#39;current&amp;amp;#39;);</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.toggle = function($li) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var closed =
!$li.hasClass(&amp;amp;#39;closed&amp;amp;#39;),</p>

<pre><code>children = $li[0].searchdoc_tree_data.children;</code></pre>

<p>$li.toggleClass(&amp;amp;#39;closed&amp;amp;#39;); for (var i=0, l =
children.length; i &amp;amp;lt; l; i++) {</p>

<pre><code>toggleVis.call(this, $(children[i].li), !closed);</code></pre>

<p>};&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.moveRight = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!this.$current) {</p>

<pre><code>this.highlight(this.$list.find(&amp;amp;#39;li:first&amp;amp;#39;));
return;</code></pre>

<p>} if (this.$current.hasClass(&amp;amp;#39;closed&amp;amp;#39;)) {</p>

<pre><code>this.toggle(this.$current);</code></pre>

<p>}&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.moveLeft = function() {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!this.$current) {</p>

<pre><code>this.highlight(this.$list.find(&amp;amp;#39;li:first&amp;amp;#39;));
return;</code></pre>

<p>} if (!this.$current.hasClass(&amp;amp;#39;closed&amp;amp;#39;)) {</p>

<pre><code>this.toggle(this.$current);</code></pre>

<p>} else {</p>

<pre><code>var level = this.$current[0].searchdoc_tree_data.level;
if (level == 0) return;
var $next = this.$current.prevAll(&amp;amp;#39;li.level_&amp;amp;#39; + (level - 1) + &amp;amp;#39;:visible:first&amp;amp;#39;);
this.$current.removeClass(&amp;amp;#39;current&amp;amp;#39;);
$next.addClass(&amp;amp;#39;current&amp;amp;#39;);
scrollIntoView($next[0], this.$element[0]);
this.$current = $next;</code></pre>

<p>}&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;this.move = function(isDown) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;if (!this.$current) {</p>

<pre><code>this.highlight(this.$list.find(&amp;amp;#39;li:first&amp;amp;#39;));
return true;</code></pre>

<p>}</p>

<p>var next = <a href="0">this.$current</a>; if (isDown) {</p>

<pre><code>do {
    next = next.nextSibling;
    if (next &amp;amp;amp;&amp;amp;amp; next.style &amp;amp;amp;&amp;amp;amp; next.style.display != &amp;amp;#39;none&amp;amp;#39;) break;
} while(next);</code></pre>

<p>} else {</p>

<pre><code>do {
    next = next.previousSibling;
    if (next &amp;amp;amp;&amp;amp;amp; next.style &amp;amp;amp;&amp;amp;amp; next.style.display != &amp;amp;#39;none&amp;amp;#39;) break;
} while(next);</code></pre>

<p>} if (next &amp;amp;amp;&amp;amp;amp;
next.className.indexOf(&amp;amp;#39;stopper&amp;amp;#39;) == -1) {</p>

<pre><code>this.$current.removeClass(&amp;amp;#39;current&amp;amp;#39;);
$(next).addClass(&amp;amp;#39;current&amp;amp;#39;);
scrollIntoView(next, this.$element[0]);
this.$current = $(next);</code></pre>

<p>} return true;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function toggleVis($li, show) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var closed =
$li.hasClass(&amp;amp;#39;closed&amp;amp;#39;),</p>

<pre><code>children = $li[0].searchdoc_tree_data.children;</code></pre>

<p>$li.css(&amp;amp;#39;display&amp;amp;#39;, show ?
&amp;amp;#39;&amp;amp;#39; : &amp;amp;#39;none&amp;amp;#39;) if (!show
&amp;amp;amp;&amp;amp;amp; this.$current &amp;amp;amp;&amp;amp;amp; $<a
href="0">li</a> == <a href="0">this.$current</a>) {</p>

<pre><code>this.$current.removeClass(&amp;amp;#39;current&amp;amp;#39;);
this.$current = null;</code></pre>

<p>} for (var i=0, l = children.length; i &amp;amp;lt; l; i++) {</p>

<pre><code>toggleVis.call(this, $(children[i].li), show &amp;amp;amp;&amp;amp;amp; !closed);</code></pre>

<p>};&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function buildAndAppendItem(item, level, before) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var li   = renderItem(item, level),</p>

<pre><code>list = this.$list[0];</code></pre>

<p>item.li = li; list.insertBefore(li, before); for (var i=0, l = <a
href="3">item</a>.length; i &amp;amp;lt; l; i++) {</p>

<pre><code>buildAndAppendItem.call(this, item[3][i], level + 1, before);</code></pre>

<p>}; return li;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function renderItem(item, level) {&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;var li =
document.createElement(&amp;amp;#39;li&amp;amp;#39;),</p>

<pre><code>cnt = document.createElement(&amp;amp;#39;div&amp;amp;#39;),
h1 = document.createElement(&amp;amp;#39;h1&amp;amp;#39;),
p = document.createElement(&amp;amp;#39;p&amp;amp;#39;),
icon, i;</code></pre>

<p>li.appendChild(cnt); li.style.paddingLeft = getOffset(level); cnt.className
= &amp;amp;#39;content&amp;amp;#39;; if (!<a href="1">item</a>)
li.className  = &amp;amp;#39;empty &amp;amp;#39;; cnt.appendChild(h1); //
cnt.appendChild(p); <a
href="0">h1.appendChild(document.createTextNode(item</a>)); // <a
href="4">p.appendChild(document.createTextNode(item</a>)); if (<a
href="2">item</a>) {</p>

<pre><code>i = document.createElement(&amp;amp;#39;i&amp;amp;#39;);
i.appendChild(document.createTextNode(item[2]));
h1.appendChild(i);</code></pre>

<p>} if (<a href="3">item</a>.length &amp;amp;gt; 0) {</p>

<pre><code>icon = document.createElement(&amp;amp;#39;div&amp;amp;#39;);
icon.className = &amp;amp;#39;icon&amp;amp;#39;;
cnt.appendChild(icon);</code></pre>

<p>}</p>

<p>// user direct assignement instead of $() // it&amp;amp;#39;s 8x faster //
$(li).data(&amp;amp;#39;path&amp;amp;#39;, <a href="1">item</a>) //    
.data(&amp;amp;#39;children&amp;amp;#39;, <a href="3">item</a>) //    
.data(&amp;amp;#39;level&amp;amp;#39;, level) //    
.css(&amp;amp;#39;display&amp;amp;#39;, level == 0 ?
&amp;amp;#39;&amp;amp;#39; : &amp;amp;#39;none&amp;amp;#39;) //    
.addClass(&amp;amp;#39;level_&amp;amp;#39; + level) //    
.addClass(&amp;amp;#39;closed&amp;amp;#39;); li.searchdoc_tree_data = {</p>

<pre><code>path: item[1],
children: item[3],
level: level</code></pre>

<p>} li.style.display = level == 0 ? &amp;amp;#39;&amp;amp;#39; :
&amp;amp;#39;none&amp;amp;#39;; li.className +=
&amp;amp;#39;level_&amp;amp;#39; + level + &amp;amp;#39;
closed&amp;amp;#39;; return li;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;}&lt;/p&gt;</p>

<p>&lt;p&gt;function getOffset(level) {&lt;/p&gt;</p>

<p>&lt;pre&gt;<code>return 5 + 18*level +
&amp;amp;#39;px&amp;amp;#39;;</code>&lt;/pre&gt;</p>

<p>&lt;p&gt;}&amp;lt;/code&amp;gt;&amp;lt;/pre&amp;gt;&lt;/p&gt;</p>

<p>&lt;p&gt;&amp;lt;p&amp;gt;});&amp;lt;/p&amp;gt;&lt;/p&gt;</p>

<p>&lt;pre&gt;&lt;code&gt;  &amp;lt;/div&amp;gt;</p>

<pre><code>&amp;lt;!-- Methods --&amp;gt;
          &amp;lt;/div&amp;gt;

&amp;lt;/div&amp;gt;</code></pre>

<p>&amp;lt;/body&amp;gt;&lt;/code&gt;&lt;/pre&gt;</p>

<p>&lt;p&gt;&amp;lt;/html&amp;gt;&lt;/p&gt;</p>

<pre><code>  &lt;/div&gt;

  &lt;!-- Methods --&gt;
            &lt;/div&gt;

  &lt;/div&gt;
&lt;/body&gt;</code></pre>

<p>&lt;/html&gt;</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
              </div>

    </div>
  </body>
</html>
